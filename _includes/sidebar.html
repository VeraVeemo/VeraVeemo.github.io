{% include base_path %}

{% if page.author_profile or layout.author_profile or page.sidebar %}
  <div class="sidebar sticky">
    {% if page.author_profile or layout.author_profile %}
      {% include author-profile.html %}
    {% endif %}

<!-- Discord Status -->
<script>
  fetch("https://api.lanyard.rest/v1/users/333585549837336577")
    .then(res => res.json())
    .then(data => {
      const presence = data.data.discord_status;
      const activities = data.data.activities;

      const statusMap = {
        online: "Online",
        idle: "Idle",
        dnd: "Do Not Disturb",
        offline: "Offline"
      };

      let display = `Discord: ${statusMap[presence] || "Unknown"}`;

      // Check for active game or custom status
      const game = activities.find(a => a.type === 0); // Playing game
      const spotify = activities.find(a => a.type === 2); // Spotify
      const customStatus = activities.find(a => a.type === 4); // Custom status

      if (spotify && spotify.details) {
        display += `<br>ðŸŽ§ Listening to <strong>${spotify.details}</strong>`;
      } else if (game && game.name) {
        display += `<br>ðŸŽ® Playing <strong>${game.name}</strong>`;
      } else if (customStatus && customStatus.state) {
        display += `<br>ðŸ’¬ ${customStatus.state}`;
      }

      document.getElementById("discord-status").innerHTML = display;
    })
    .catch(() => {
      document.getElementById("discord-status").innerText = "Discord: Offline";
    });
</script>
